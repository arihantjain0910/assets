<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fixed Assets Requisition Form</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        padding-top: 0px;
        font-size: 0.7rem;
      }
      label {
        font-weight: 700;
      }
      .small-input {
        height: 30px;
        padding: 0.2rem;
      }
      .navbar {
        font-size: 0.9rem;
        height: 50px;
      }
      .container {
        padding-top: 1%;
      }
      .heading {
        color: rgb(0, 0, 0);
        font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande",
          "Lucida Sans", Arial, sans-serif;
        font-style: italic;
        font-weight: 800;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="">
          <img
            src="https://sangamgroup.com/wp-content/uploads/2023/01/sangam_group_logo.png"
            alt="Logo"
            width="50"
            height="43"
          />
          Sangam India Limited
        </a>
        <a href="/logout" class="nav-link" style="color: white">Logout</a>
      </div>
    </nav>
    <div class="container mt-5">
      <h4 class="text-center mb-4 heading">Fixed Assets Requisition Form</h4>
      <form action="/submit-form" method="POST">
        <div class="row mb-3">
          <div class="col-md-2">
            <label for="plant" class="form-label">Plant</label>
            <select
              class="form-select small-input"
              id="plant"
              name="plant"
              required
            >
              <option value="" disabled selected>Select Plant</option>
              <option value="1100">1100 (BILIYA)</option>
              <option value="1110">1110 (SARERI)</option>
              <option value="1120">1120 (SONIYANA)</option>
              <option value="1200">1200 (DENIM)</option>
              <option value="1300">1300 (WEAVING)</option>
              <option value="1400">1400 (PROCESS)</option>
              <option value="1500">1500 (SEAMLESS)</option>
              <option value="3500">3500 (SVL)</option>
            </select>
          </div>
          <div class="col-md-2">
            <label for="profitCenter" class="form-label">Profit Center</label>
            <select
              class="form-select small-input"
              id="profitCenter"
              name="profitCenter"
              required
            >
              <option value="" disabled selected>Select Profit Center</option>
              <option>11010</option>
              <option>11110</option>
              <option>11120</option>
              <option>11210</option>
              <option>12010</option>
              <option>13010</option>
              <option>14010</option>
              <option>15010</option>
              <option>35010</option>
            </select>
          </div>
          <div class="col-md-2">
            <label for="dateOfRequisition" class="form-label">Date</label>
            <input
              type="date"
              class="form-control small-input"
              id="dateOfRequisition"
              name="dateOfRequisition"
              required
              readonly
            />
          </div>
          <div class="col-md-2">
            <label for="type" class="form-label">Type</label>
            <select
              class="form-select small-input"
              id="type"
              name="type"
              required
            >
              <option value="" disabled selected>Select</option>
              <option>MATERIAL</option>
              <option>SERVICE</option>
            </select>
          </div>
          <div class="col-md-4">
            <label for="remarks" class="form-label">Remarks</label>
            <input
              type="text"
              class="form-control small-input"
              id="remarks"
              name="remarks"
            />
          </div>
          <div class="col-md-5 mt-2">
            <label for="assetProcuredAgainst" class="form-label"
              >Is assets procured against replacement/modification/upgradation
              with earlier assets</label
            >
            <select
              class="form-select small-input"
              id="assetProcuredAgainst"
              name="assetProcuredAgainst"
            >
              <option value="" selected></option>
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
          </div>
          <div class="col-md-7 mt-2">
            <label for="assetsAgainstReplacement" class="form-label"
              >Name of Assets against replacement to be procured (Last detail of
              assets purchase, make, model, serial no., our asset marking
              etc)</label
            >
            <input
              type="text"
              class="form-control small-input"
              id="assetsAgainstReplacement"
              name="assetsAgainstReplacement"
            />
          </div>
        </div>

        <!-- Table for Material Details -->
        <div>
          <table class="table table-bordered mt-3" id="materialTable">
            <thead>
              <tr>
                <th>SN No.</th>
                <th>Material Code</th>
                <th>Description</th>
                <th>Qty</th>
                <th>Purchase Type</th>
                <th>Cost Center</th>
                <th>Total Cost</th>
                <th>Payback Period</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>
                  <input
                    type="text"
                    class="form-control small-input"
                    name="materialCode[]"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control small-input"
                    name="description[]"
                    required
                  />
                </td>
                <td>
                  <input
                    type="number"
                    step="0.01"
                    class="form-control small-input"
                    name="qty[]"
                    required
                  />
                </td>
                <td>
                  <select
                    class="form-select small-input"
                    name="purchaseType[]"
                    required
                  >
                    <option value="" disabled selected>Select</option>
                    <option>NEW</option>
                    <option>SECOND HAND</option>
                  </select>
                </td>
                <td>
                  <select
                    name="cost_center[]"
                    id="cost_center"
                    class="form-select small-input"
                  >
                    <option value="" selected>Select</option>
                  </select>
                </td>
                <td>
                  <input
                    type="number"
                    step="0.01"
                    class="form-control small-input"
                    name="totalCost[]"
                    required
                  />
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control small-input"
                    name="paybackPeriod[]"
                  />
                </td>
                <td>
                  <button
                    type="button"
                    class="btn btn-danger btn-sm remove-row"
                  >
                    Delete
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <button type="button" class="btn btn-primary btn-sm" id="addRow">
          Add Row
        </button>
        <button type="submit" class="btn btn-success btn-sm">Submit</button>
      </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        let rowIdx = 1;

        // Function to update cost center options based on selected plant
        function updateCostCenter(plant) {
          const costCenters = {
            1100: ["11001100", "11001101", "11001102"],
            1110: ["11101100", "11101101", "11101102"],
            1120: ["11201100", "11201101", "11201102"],
            1200: ["12001100", "12001101", "12001102"],
            1300: ["13001100", "13001101", "13001102"],
            1400: ["14001100", "14001101", "14001102"],
            1500: ["15001100", "15001101", "15001102"],
            3500: ["35001100", "35001101", "35001102"],
          };

          const costCenterSelect = $('select[name="cost_center[]"]');
          costCenterSelect.empty(); // Clear existing options
          costCenterSelect.append('<option value="" selected>Select</option>');

          if (costCenters[plant]) {
            costCenters[plant].forEach(function (cc) {
              costCenterSelect.append(`<option value="${cc}">${cc}</option>`);
            });
          }
        }

        $("#plant").change(function () {
          const selectedPlant = $(this).val();
          updateCostCenter(selectedPlant);
        });

        $("#addRow").on("click", function () {
          rowIdx++;
          $("#materialTable tbody").append(`
                <tr>
                    <td>${rowIdx}</td>
                    <td><input type="text" class="form-control small-input" name="materialCode[]"></td>
                    <td><input type="text" class="form-control small-input" name="description[]"></td>
                    <td><input type="number" step="0.01" class="form-control small-input" name="qty[]"></td>
                    <td>
                        <select class="form-select small-input" name="purchaseType[]">
                            <option value="" selected>Select</option>
                            <option>NEW</option>
                            <option>SECOND HAND</option>
                        </select>
                    </td>
                    <td>
                    <select
                        name="cost_center[]"
                        id="cost_center"
                        class="form-select small-input"
                        >
                  <option value="" selected>Select</option>
                </select>
              </td>
                    <td><input type="number" step="0.01" class="form-control small-input" name="totalCost[]"></td>
                    <td><input type="text" class="form-control small-input" name="paybackPeriod[]"></td>
                    <td>
                        <button type="button" class="btn btn-danger btn-sm remove-row">Delete</button>
                    </td>
                </tr>
            `);
        });

        $("#materialTable").on("click", ".remove-row", function () {
          $(this).closest("tr").remove();
          rowIdx--;
          $("#materialTable tbody tr").each(function (index) {
            $(this)
              .find("td:first")
              .text(index + 1);
          });
        });
      });
    </script>
    <script>
      const today = new Date().toISOString().split("T")[0];
      document.getElementById("dateOfRequisition").value = today;
    </script>
  </body>
</html>
